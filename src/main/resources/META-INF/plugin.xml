<idea-plugin>
    <id>com.bogdanbujor.azure-templates-navigator</id>
    <name>Azure Templates Navigator</name>
    <vendor email="bogdan@bogdanbujor.com" url="https://github.com/qSharpy">bogdanbujor</vendor>
    <description><![CDATA[
        <p><b>Azure Templates Navigator</b> supercharges your Azure DevOps pipeline development in IntelliJ-based IDEs.</p>

        <p>Working with Azure Pipelines templates across multiple repositories? This plugin gives you full IDE support
        for template references — hover documentation, go-to-declaration, autocompletion, and real-time validation.</p>

        <h3>Features</h3>
        <ul>
            <li><b>Hover Documentation</b> — hover over any template reference to see its parameters, types, and default values</li>
            <li><b>Go-to-Declaration</b> — Ctrl+Click (or Cmd+Click) on a template path to jump directly to the template file</li>
            <li><b>Parameter Autocompletion</b> — get intelligent suggestions for template parameters as you type</li>
            <li><b>Parameter Validation</b> — real-time inspections flag missing required parameters and unknown parameter names</li>
            <li><b>Variable Hover</b> — hover over pipeline variables to see their values</li>
            <li><b>Dependency Tree</b> — visualize the full template dependency hierarchy in a dedicated tool window</li>
            <li><b>Interactive Graph</b> — explore template relationships with an interactive D3.js-powered graph visualization</li>
            <li><b>Diagnostics Panel</b> — see all template issues across your project in one place</li>
            <li><b>Cross-Repository Support</b> — resolves templates from sibling repositories on disk</li>
        </ul>

        <h3>Supported File Types</h3>
        <p>YAML files containing Azure Pipelines definitions (azure-pipelines.yml, templates, stages, jobs, etc.)</p>
    ]]></description>

    <change-notes><![CDATA[
        <h3>1.1.0</h3>
        <ul>
            <li><b>Quick-fix actions</b> — one-click fixes for missing required parameters, unknown parameters, and type mismatches directly in the editor</li>
            <li><b>Performance improvements</b> — background indexing prevents IDE freezes on large workspaces; VFS-based file reads replace blocking I/O</li>
            <li><b>Full path toggle</b> — switch between short and full file paths in the Dependency Tree and Graph tool windows</li>
            <li><b>Graph enhancements</b> — zoom controls, improved force-directed layout, and a legend for node types</li>
            <li><b>Improved documentation styling</b> — richer hover tooltips with better HTML formatting</li>
            <li><b>Better template resolution</b> — more robust go-to-declaration for cross-repo and relative template paths</li>
            <li><b>Robustness fixes</b> — regex constants extracted to companion objects, mutable data class fields eliminated, flexible indent detection in parameter parser</li>
        </ul>
        <h3>1.0.0</h3>
        <ul>
            <li>Initial release</li>
            <li>Template parameter hover documentation</li>
            <li>Go-to-declaration for template references</li>
            <li>Parameter autocompletion with type information</li>
            <li>Real-time template parameter validation inspections</li>
            <li>Gutter icons for template references</li>
            <li>Dependency tree tool window</li>
            <li>Interactive D3.js template graph visualization</li>
            <li>Diagnostics tool window for project-wide template issues</li>
            <li>Cross-repository template resolution</li>
            <li>Configurable sibling repository paths</li>
        </ul>
    ]]></change-notes>

    <depends>com.intellij.modules.platform</depends>
    <depends>org.jetbrains.plugins.yaml</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Documentation (hover) -->
        <lang.documentationProvider language="yaml"
            implementationClass="com.bogdanbujor.azuretemplates.providers.TemplateDocumentationProvider"/>

        <!-- Go-to-declaration -->
        <gotoDeclarationHandler
            implementation="com.bogdanbujor.azuretemplates.providers.TemplateGotoDeclarationHandler"/>

        <!-- Completion -->
        <completion.contributor language="yaml"
            implementationClass="com.bogdanbujor.azuretemplates.providers.TemplateCompletionContributor"/>

        <!-- Inspection (diagnostics) -->
        <localInspection language="yaml"
            groupName="Azure Templates Navigator"
            displayName="Template parameter validation"
            enabledByDefault="true"
            level="ERROR"
            implementationClass="com.bogdanbujor.azuretemplates.providers.TemplateInspection"/>

        <!-- Line markers (gutter icons) -->
        <codeInsight.lineMarkerProvider language="yaml"
            implementationClass="com.bogdanbujor.azuretemplates.providers.TemplateLineMarkerProvider"/>

        <!-- Tool windows -->
        <toolWindow id="Azure Templates - Dependencies"
            anchor="right"
            factoryClass="com.bogdanbujor.azuretemplates.ui.DependencyTreeToolWindow"
            icon="AllIcons.Nodes.TreeOpen"/>

        <toolWindow id="Azure Templates - Graph"
            anchor="right"
            factoryClass="com.bogdanbujor.azuretemplates.ui.GraphToolWindow"
            icon="AllIcons.Nodes.DataTables"/>

        <toolWindow id="Azure Templates - Diagnostics"
            anchor="bottom"
            factoryClass="com.bogdanbujor.azuretemplates.ui.DiagnosticsToolWindow"
            icon="AllIcons.General.InspectionsEye"/>

        <!-- Settings -->
        <applicationConfigurable
            parentId="tools"
            instance="com.bogdanbujor.azuretemplates.settings.PluginSettingsConfigurable"
            id="com.bogdanbujor.azuretemplates.settings"
            displayName="Azure Templates Navigator"/>

        <applicationService
            serviceImplementation="com.bogdanbujor.azuretemplates.settings.PluginSettings"/>

        <!-- Project service -->
        <projectService
            serviceImplementation="com.bogdanbujor.azuretemplates.services.TemplateIndexService"/>
    </extensions>

    <actions>
        <group id="AzureTemplatesNavigator.ToolbarActions" text="Azure Templates Navigator">
            <action id="AzureTemplatesNavigator.RefreshTree"
                class="com.bogdanbujor.azuretemplates.actions.RefreshTreeAction"
                text="Refresh Template Tree"
                icon="AllIcons.Actions.Refresh"/>
            <action id="AzureTemplatesNavigator.RefreshGraph"
                class="com.bogdanbujor.azuretemplates.actions.RefreshGraphAction"
                text="Refresh Template Graph"
                icon="AllIcons.Actions.Refresh"/>
            <action id="AzureTemplatesNavigator.RefreshDiagnostics"
                class="com.bogdanbujor.azuretemplates.actions.RefreshDiagnosticsAction"
                text="Refresh Diagnostics"
                icon="AllIcons.Actions.Refresh"/>
        </group>
    </actions>
</idea-plugin>
